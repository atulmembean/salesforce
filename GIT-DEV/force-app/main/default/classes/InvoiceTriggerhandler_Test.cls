@isTest(seeAllData = true)
public class InvoiceTriggerhandler_Test {

    static testMethod void validateUpdateInvoiceDetails(){
        Test.startTest();
        Invoice__c inv = [select Id,Due_Date__c from Invoice__c where Paypal_status__c = 'Sent' order by createdDate DESC limit 1];
        inv.Due_Date__c = System.Today().addDays(10);
        update inv;
        Test.stopTest();
    }
    
    @isTest static void validateDeleteInvoice(){
        
        SingleRequestMock res = new SingleRequestMock(200,'OK','{"scope": "https://uri.paypal.com/services/invoicing https://uri.paypal.com/services/disputes/read-buyer https://uri.paypal.com/services/payments/realtimepayment https://uri.paypal.com/services/disputes/update-seller https://uri.paypal.com/services/payments/payment/authcapture openid https://uri.paypal.com/services/disputes/read-seller https://uri.paypal.com/services/payments/refund https://api.paypal.com/v1/vault/credit-card https://api.paypal.com/v1/payments/.* https://uri.paypal.com/payments/payouts https://api.paypal.com/v1/vault/credit-card/.* https://uri.paypal.com/services/subscriptions https://uri.paypal.com/services/applications/webhooks","access_token": "A21AAECGwXimulfBXrIxG-e7-xht6SpBJv0bwfXt7AX3EVgb3FXRXIZX3zT5qw-0dCQxUGybUALeEtb_GzB9ToOj72hlJLZVw","token_type": "Bearer","app_id": "APP-80W284485P519543T","expires_in": 32400,"nonce": "2020-05-01T13:14:19ZpPltRaMoQr-b3CzoXM7V3yz105akh4yO_ge18ZiPNws","total_count": 589,"invoices": [{"id": "INV2-RF6D-L66T-D7H2-CRU7","number": "INV 01256","status": "DRAFT","merchant_info":{"email": "dlarusso@example.com","first_name": "David","last_name": "Larusso","business_name": "Mitchell & Murray","phone":{"country_code": "001","national_number": "4085551234"},"address":{"line1": "1234 First Street","city": "Anytown","state": "CA","postal_code": "98765","country_code": "US"}},"billing_info": [{"email": "stmeyers@example.com","first_name": "Stephanie","last_name": "Meyers"}],"shipping_info":{"first_name": "Stephanie","last_name": "Meyers","address":{"line1": "1234 Main Street","city": "Anytown","state": "CA","postal_code": "98765","country_code": "US"}},"invoice_date": "2017-06-22 PDT","note": "Thank you for your business.","total_amount":{"currency": "USD","value": "387.30"},"metadata":{"created_date": "2017-02-27 23:55:58 PST"}},{"id": "INV2-RF6D-L66T-D7H2-CRU7","number": "9879878979003790","status": "DRAFT","merchant_info":{"email": "dlarusso@example.com","first_name": "David","last_name": "Larusso","business_name": "Mitchell & Murray","phone":{"country_code": "001","national_number": "4085551234"},"address":{"line1": "1234 First Street","city": "Anytown","state": "CA","postal_code": "98765","country_code": "US"}},"billing_info": [{"email": "stmeyers@example.com","first_name": "Stephanie","last_name": "Meyers"}],"shipping_info":{"first_name": "Stephanie","last_name": "Meyers","address":{"line1": "1234 Main Street","city": "Anytown","state": "CA","postal_code": "98765","country_code": "US"}},"invoice_date": "2017-06-22 PDT","note": "Thank you for your business.","total_amount":{"currency": "USD","value": "387.30"},"metadata":{"created_date": "2017-02-27 23:55:58 PST"}},{"id": "INV2-RF6D-L66T-D7H2-CRU7","number": "9879878979003789","status": "DRAFT","merchant_info":{"email": "dlarusso@example.com","first_name": "David","last_name": "Larusso","business_name": "Mitchell & Murray","phone":{"country_code": "001","national_number": "4085551234"},"address":{"line1": "1234 First Street","city": "Anytown","state": "CA","postal_code": "98765","country_code": "US"}},"billing_info": [{"email": "stmeyers@example.com","first_name": "Stephanie","last_name": "Meyers"}],"shipping_info":{"first_name": "Stephanie","last_name": "Meyers","address":{"line1": "1234 Main Street","city": "Anytown","state": "CA","postal_code": "98765","country_code": "US"}},"invoice_date": "2017-06-22 PDT","note": "Thank you for your business.","total_amount":{"currency": "USD","value": "387.30"},"metadata":{"created_date": "2017-02-27 23:55:58 PST"}},{"id": "INV2-RF6D-L66T-D7H2-CRU7","number": "9879878979003788","status": "DRAFT","merchant_info":{"email": "dlarusso@example.com","first_name": "David","last_name": "Larusso","business_name": "Mitchell & Murray","phone":{"country_code": "001","national_number": "4085551234"},"address":{"line1": "1234 First Street","city": "Anytown","state": "CA","postal_code": "98765","country_code": "US"}},"billing_info": [{"email": "stmeyers@example.com","first_name": "Stephanie","last_name": "Meyers"}],"shipping_info":{"first_name": "Stephanie","last_name": "Meyers","address":{"line1": "1234 Main Street","city": "Anytown","state": "CA","postal_code": "98765","country_code": "US"}},"invoice_date": "2017-06-22 PDT","note": "Thank you for your business.","total_amount":{"currency": "USD","value": "387.30"},"metadata":{"created_date": "2017-02-27 23:55:58 PST"}}],"links": [{"href": "https://api.sandbox.paypal.com/v1/invoicing/invoices?page=4&page_size=4&total_count_required=true","rel": "next","method": "GET"},{"href": "https://api.sandbox.paypal.com/v1/invoicing/invoices?page=2&page_size=4&total_count_required=true","rel": "previous","method": "GET"}],"receipt_payment": {"transaction_id": "4GH78323HF488873C","payment_status": "COMPLETE","payment_time": "1586971908","payment_method": [{"amount": {"currency": "USD","value": "10.0"}}],"customer_data": []}}',null);
        
      Test.StartTest();
        Test.setMock(HttpCalloutMock.class, res);
        List<Invoice__c> invdel = [Select Id,Paypal_Invoice_Id__c,Paypal_Invoice__c,paypal_send_url__c,Paypal_status__c from Invoice__c where Paypal_status__c = 'Sent' order by createdDate DESC limit 1];
        InvoiceTriggerHandler.invokePaypalHandlerforDeleteInvoice(invdel);
        Test.stopTest();
    }
    
}